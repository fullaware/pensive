services:
  backend:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: pensive-backend
    ports:
      - "8383:8000"
    environment:
      - MONGODB_URI=${MONGODB_URI}
      - MONGODB_DB=${MONGODB_DB:-chat_db}
      - LLM_MODEL=${LLM_MODEL}
      - LLM_URI=${LLM_URI}
      - LLM_API_KEY=${LLM_API_KEY:-}
      - LLM_EMBEDDING_MODEL=${LLM_EMBEDDING_MODEL:-}
      - VECTOR_DIMENSIONS=${VECTOR_DIMENSIONS:-0}
      - SESSION_TIMEOUT_MINUTES=${SESSION_TIMEOUT_MINUTES:-480}
      - DEFAULT_ADMIN_USERNAME=${DEFAULT_ADMIN_USERNAME:-admin}
      - DEFAULT_ADMIN_PASSWORD=${DEFAULT_ADMIN_PASSWORD:-changeme}
      - METRICS_RETENTION_DAYS=${METRICS_RETENTION_DAYS:-90}
      - FRONTEND_ORIGINS=${FRONTEND_ORIGINS:-http://localhost:8080,http://mouse.home.fullaware.com:8080}
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
      args:
        NEXT_PUBLIC_API_URL: http://localhost:8383
    container_name: pensive-frontend
    ports:
      - "8080:3000"
    depends_on:
      - backend
    restart: unless-stopped


